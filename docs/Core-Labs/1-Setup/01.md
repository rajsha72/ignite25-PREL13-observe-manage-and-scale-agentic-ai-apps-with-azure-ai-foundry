# 1.1 Provision Infra

!!! quote "BY THE END OF THIS LAB YOU SHOULD HAVE"

    - [X] Launched GitHub Codespaces (and setup local environment)
    - [X] Created a personal copy of repo (to make changes & revisit)
    - [X] Provisioned Infrastructure (to get an Azure AI Foundry project)

---

## 1. Launch GitHub Codespaces

1. Navigate to [https://github.com](https://github.com) â†’ login with a personal profile
1. Navigate to [https://aka.ms/ignite25/preday/prebuild](https://aka.ms/ignite25/preday/prebuild) â†’ you should see this:

    ![Codespaces Workshop](./../assets/1-codespace-workshop.png)

1. Click "Create Codespace" â†’ you see a new browser tab with a VS Code IDE
1. Wait till GitHub Codespaces is loaded and VS Code terminal is ready.

!!! success "Your GitHub Codespaces is Ready!"

---

## 2. Create Personal Fork

You are currently in a GitHub Codespaces running on the original repo. In this step, we'll help you make a fork of that repo to your personal profile so you can revisit this later (and save your work).

!!! danger "NITYA-TODO: Grab instructions from Contoso Chat"


---

## 3. Provision Infrastructure

You need an Azure AI Foundry project for this lab, along with supporting Azure resources (e.g., Azure AI Search, App Insights etc.). In this step, we'll streamline that provisioning process by using a custom version of the [_Get Started With AI Agents_](https://ai.azure.com/templates) app template from Azure AI Foundry.

=== "Instructor-Led (In Venue)"

    - [X] You should have Azure credentials in your Skillable VM
    - [X] We pre-provisioned infrastructure in this subscription

    !!! success "YOU ARE SET! Let's validate the infrastructure, next."

=== "Self-Guided (At Home)"

    ??? task "STEP 1: You need to provision the infrastructure - get the template!"

        1. Navigate to our [Custom Template](https://aka.ms/ignite25/preday/azd-template) for this lab
        1. Fork it to your profile to get a custom copy (.e., [my fork-branch](https://github.com/nitya/get-started-with-ai-agents/tree/sep2025-pdy123-infra))
        1. Launch GitHub Codespaces on your fork
        1. Wait till the browser VS Code loads - and an active terminal appears.

        _You are ready to deploy the template_

    ??? task "STEP 2: You need customize template - setup env variables!"

        The azd template can be customized in many ways - the easiest starting point is to use environment variables to customize the resource deployment paramters. Run these commands in the Codespaces terminal.  _Note: Pick unique names for the last 2 variables that set the Foundry project and resource names in Azure AI Foundry Portal_

        ```bash
        azd env set AZURE_AI_AGENT_DEPLOYMENT_CAPACITY 100
        azd env set ENABLE_AZURE_MONITOR_TRACING true
        azd env set AZURE_TRACING_GEN_AI_CONTENT_RECORDING_ENABLED true
        azd env set USE_AZURE_AI_SEARCH_SERVICE true
        azd env set USE_APPLICATION_INSIGHTS true
        azd env set AZURE_AIPROJECT_NAME nitya-pdy123-aiproj-v1
        azd env set AZURE_AISERVICES_NAME nitya-pdy123-aisvcs-v1
        ```
    ??? task "STEP 3: You are ready to deploy it - have your Azure subscription ready!"

        You should already have the Azure Developer CLI (`azd`) tool installed in the GitHub Codespaces environment. Provisioning and deployment is now just a single command:

        ```title="" linenums="0"
        azd up
        ```

        Note that we did not have to authenticate beforehand! This command will prompt you to do so, using a device-code workflow that looks something like this:

        ```title="" linenums="0"
        ? Would you like to log in now? Yes

        Start by copying the next code: XXXXXXX
        Then press enter and continue to log in from your browser...
        ```

        Next you'll be prompted to select your subscription and the region for deployment. I used `East US2`. 
        
    ??? task "STEP 4: Wait for the provisioning to complete - it can take 10-15 mins!"

        You can track the deployments status in the Azure Portal (at the link you will see in your console logs). Wait for the **SUCCESS** message to ensure provisioning is done.

        ```title="" linenums="0"
        You can view detailed progress in the Azure Portal:
        <url here>

        (âœ“) Done: Resource group: rg-nitya-pdy123-azd-v1 (447ms)
        (âœ“) Done: Log Analytics workspace: log-vchqcvq7rwoju (22.557s)
        (âœ“) Done: Storage account: stvchqcvq7rwoju (20.675s)
        (âœ“) Done: Application Insights: appi-vchqcvq7rwoju (3.537s)
        (âœ“) Done: Azure AI Services: nitya-pdy123-aisvcs-v1 (1m8.574s)
        (âœ“) Done: Azure AI Services Model Deployment: nitya-pdy123-aisvcs-v1/text-embedding-3-small (1m10.589s)
        (âœ“) Done: Azure AI Services Model Deployment: nitya-pdy123-aisvcs-v1/gpt-4o-mini (1m10.027s)
        (âœ“) Done: Search service: srch-vchqcvq7rwoju (4m50.479s)
        (âœ“) Done: Container Registry: crvchqcvq7rwoju (19.98s)
        (âœ“) Done: Container Apps Environment: containerapps-env-vchqcvq7rwoju (1m24.269s)
        (âœ“) Done: Container App: ca-api-vchqcvq7rwoju (17.742s)

        Deploying services (azd deploy)

        Deploying service api_and_frontend (Running remote build)
        - Endpoint: https://......eastus2.azurecontainerapps.io/
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Docker Output â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

        ðŸ’¡ (Optional) To setup username and password for the web application, run './scripts/setup_credential.sh'.

        SUCCESS: Your up workflow to provision and deploy to Azure completed in 11 minutes 50 seconds.
        ```
    !!! success "YOU ARE SET! Let's validate the infrastructure, next."
